{
    "server": {
        "address": "0.0.0.0",
        "port": 8080,
        "read_timeout": 10000000000,
        "write_timeout": 10000000000,
        "idle_timeout": 60000000000,
        "max_connections": 10000,
        "enable_prefork": false,
        "body_limit": 10485760,
        "trusted_proxies": [ "127.0.0.1", "::1" ]
    },
    "engine": {
        "max_concurrent_requests": 1000,
        "request_timeout": 30000000000,
        "enable_metrics": true,
        "enable_events": true,
        "default_action": "allow",
        "failure_mode": "allow",
        "action_rules": [
            {
                "name": "Critical Account Suspension",
                "description": "Suspend accounts for critical severity threats",
                "min_severity": 9,
                "min_confidence": 0.9,
                "actions": [ "account_suspend_action" ],
                "priority": 100,
                "enabled": true
            },
            {
                "name": "High Severity Suspension",
                "description": "Temporary suspension for high severity threats",
                "min_severity": 8,
                "min_confidence": 0.8,
                "actions": [ "suspension_action" ],
                "priority": 90,
                "enabled": true
            },
            {
                "name": "Rate Limit Block",
                "description": "Block IPs that exceed rate limits",
                "min_severity": 5,
                "min_confidence": 0.8,
                "actions": [ "block_action" ],
                "threat_tags": [ "rate_limit", "ddos" ],
                "priority": 85,
                "enabled": true
            },
            {
                "name": "SQL Injection Block",
                "description": "Block SQL injection attempts immediately",
                "min_severity": 1,
                "min_confidence": 0.7,
                "actions": [ "block_action" ],
                "threat_tags": [ "sql_injection" ],
                "priority": 95,
                "enabled": true
            },
            {
                "name": "XSS Attack Block",
                "description": "Block XSS attacks with medium confidence",
                "min_severity": 1,
                "min_confidence": 0.6,
                "actions": [ "block_action" ],
                "threat_tags": [ "xss" ],
                "priority": 94,
                "enabled": true
            },
            {
                "name": "Path Traversal Block",
                "description": "Block path traversal attempts",
                "min_severity": 1,
                "min_confidence": 0.8,
                "actions": [ "block_action" ],
                "threat_tags": [ "path_traversal" ],
                "priority": 93,
                "enabled": true
            },
            {
                "name": "Brute Force Block",
                "description": "Block brute force login attempts",
                "min_severity": 4,
                "min_confidence": 0.7,
                "actions": [ "incremental_block_action" ],
                "threat_tags": [ "brute_force", "login_abuse" ],
                "priority": 88,
                "enabled": true
            },
            {
                "name": "Suspicious Behavior Warning",
                "description": "Warn about suspicious but not clearly malicious behavior",
                "min_severity": 3,
                "max_severity": 4,
                "min_confidence": 0.3,
                "actions": [ "warning_action" ],
                "priority": 70,
                "enabled": true
            },
            {
                "name": "Low Confidence Monitoring",
                "description": "Monitor low confidence threats without blocking",
                "min_severity": 1,
                "max_confidence": 0.5,
                "actions": [ "warning_action" ],
                "exclude_tags": [ "sql_injection", "xss", "rate_limit" ],
                "priority": 60,
                "enabled": true
            }
        ]
    },
    "store": {
        "type": "memory",
        "address": "",
        "password": "",
        "database": 0,
        "prefix": "ddos_protection:",
        "max_retries": 3,
        "timeout": 5000000000,
        "options": {
            "cleanup_interval": "1m",
            "max_memory_usage": "100MB"
        }
    },
    "events": {
        "buffer_size": 1000,
        "worker_count": 4,
        "enable_async": true,
        "retry_attempts": 3
    },
    "plugins": {
        "detectors": {
            "rate_limit_detector": {
                "enabled": true,
                "priority": 90,
                "parameters": {
                    "window_size": "1m",
                    "max_requests": 100,
                    "key_template": "rate_limit:{ip}",
                    "burst_allowed": 10,
                    "cleanup_period": "5m"
                }
            },
            "sql_injection_detector": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "custom_patterns": [
                        "(?i)(union|select|insert|update|delete|drop|create|alter)\\s+",
                        "(?i)'\\s*(or|and)\\s*'",
                        "(?i)\\b(exec|execute|sp_|xp_)\\w*\\s*\\(",
                        "(?i)--\\s*$",
                        "(?i)/\\*.*\\*/",
                        "(?i)\\b(script|javascript|vbscript)\\s*:",
                        "(?i)<\\s*script[^>]*>.*?</\\s*script\\s*>"
                    ],
                    "check_headers": true,
                    "check_query_params": true,
                    "check_body": true,
                    "max_body_size": 1048576
                }
            },
            "xss_detector": {
                "enabled": true,
                "priority": 95,
                "parameters": {
                    "patterns": [
                        "(?i)<\\s*script[^>]*>",
                        "(?i)javascript\\s*:",
                        "(?i)on\\w+\\s*=",
                        "(?i)<\\s*iframe[^>]*>",
                        "(?i)<\\s*object[^>]*>",
                        "(?i)<\\s*embed[^>]*>",
                        "(?i)eval\\s*\\(",
                        "(?i)alert\\s*\\(",
                        "(?i)confirm\\s*\\(",
                        "(?i)prompt\\s*\\("
                    ],
                    "check_all_params": true,
                    "decode_url": true,
                    "decode_html": true
                }
            },
            "path_traversal_detector": {
                "enabled": true,
                "priority": 85,
                "parameters": {
                    "patterns": [
                        "\\.\\./",
                        "\\.\\.\\\\",
                        "%2e%2e%2f",
                        "%2e%2e%5c",
                        "..%2f",
                        "..%5c",
                        "%252e%252e%252f",
                        "etc/passwd",
                        "windows/system32",
                        "/proc/",
                        "boot.ini"
                    ],
                    "check_path": true,
                    "check_query_params": true,
                    "normalize_path": true
                }
            },
            "brute_force_detector": {
                "enabled": true,
                "priority": 80,
                "parameters": {
                    "login_endpoints": [ "/login", "/auth", "/signin", "/api/auth" ],
                    "max_attempts": 5,
                    "window_size": "5m",
                    "key_template": "brute_force:{ip}:{endpoint}",
                    "track_usernames": true,
                    "username_limit": 10
                }
            },
            "suspicious_user_agent_detector": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "suspicious_patterns": [
                        "(?i)(bot|crawler|spider|scraper)",
                        "(?i)(curl|wget|python|java)",
                        "(?i)(nmap|nikto|sqlmap|burp)",
                        "(?i)(scanner|exploit|hack)",
                        "^$",
                        "^\\s*$"
                    ],
                    "whitelist_patterns": [
                        "(?i)googlebot",
                        "(?i)bingbot",
                        "(?i)facebookexternalhit",
                        "(?i)twitterbot"
                    ],
                    "severity": 3
                }
            },
            "geo_location_detector": {
                "enabled": false,
                "priority": 60,
                "parameters": {
                    "blocked_countries": [ "CN", "RU", "KP" ],
                    "allowed_countries": [ ],
                    "use_cloudflare_headers": true,
                    "severity": 4
                }
            }
        },
        "actions": {
            "block_action": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "default_duration": "5m",
                    "max_duration": "24h",
                    "block_message": "Access denied due to security policy violation",
                    "log_blocks": true,
                    "escalation_rules": [
                        {
                            "violation_count": 1,
                            "duration": "5m",
                            "permanent": false
                        },
                        {
                            "violation_count": 3,
                            "duration": "30m",
                            "permanent": false
                        },
                        {
                            "violation_count": 5,
                            "duration": "2h",
                            "permanent": false
                        },
                        {
                            "violation_count": 10,
                            "duration": "24h",
                            "permanent": false
                        },
                        {
                            "violation_count": 20,
                            "duration": "0",
                            "permanent": true
                        }
                    ]
                }
            },
            "incremental_block_action": {
                "enabled": true,
                "priority": 90,
                "parameters": {
                    "initial_duration": "1m",
                    "max_duration": "1h",
                    "multiplier": 2.0,
                    "reset_after": "24h",
                    "log_blocks": true
                }
            },
            "suspension_action": {
                "enabled": true,
                "priority": 85,
                "parameters": {
                    "default_duration": "1h",
                    "max_duration": "7d",
                    "require_manual_review": true,
                    "notification_email": "security@example.com"
                }
            },
            "account_suspend_action": {
                "enabled": true,
                "priority": 95,
                "parameters": {
                    "permanent": true,
                    "require_admin_approval": true,
                    "notification_email": "admin@example.com",
                    "log_suspension": true
                }
            },
            "warning_action": {
                "enabled": true,
                "priority": 50,
                "parameters": {
                    "log_warnings": true,
                    "include_details": true,
                    "rate_limit_warnings": true,
                    "max_warnings_per_hour": 10
                }
            },
            "captcha_action": {
                "enabled": false,
                "priority": 75,
                "parameters": {
                    "provider": "recaptcha",
                    "site_key": "",
                    "secret_key": "",
                    "threshold": 0.5,
                    "duration": "10m"
                }
            }
        },
        "handlers": {
            "security_logger_handler": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "log_file": "security_events.log",
                    "log_level": "INFO",
                    "event_types": [ "*" ],
                    "format": "json",
                    "max_file_size": "100MB",
                    "max_backups": 5,
                    "compress": true,
                    "include_request_details": true
                }
            },
            "webhook_handler": {
                "enabled": false,
                "priority": 90,
                "parameters": {
                    "webhook_url": "https://your-webhook-endpoint.com/security-events",
                    "timeout": "10s",
                    "retry_attempts": 3,
                    "event_types": [ "threat_detected", "action_executed" ],
                    "include_metadata": true,
                    "authentication": {
                        "type": "bearer",
                        "token": "your-webhook-token"
                    }
                }
            },
            "email_handler": {
                "enabled": false,
                "priority": 80,
                "parameters": {
                    "smtp_host": "smtp.example.com",
                    "smtp_port": 587,
                    "username": "alerts@example.com",
                    "password": "your-password",
                    "from": "DDoS Protection <alerts@example.com>",
                    "to": [ "security@example.com" ],
                    "subject_template": "Security Alert: {{.Type}}",
                    "severity_threshold": 7,
                    "rate_limit": "1/5m"
                }
            },
            "metrics_handler": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "export_interval": "30s",
                    "metrics_endpoint": "/metrics",
                    "include_labels": true,
                    "histogram_buckets": [ 0.1, 0.5, 1.0, 2.5, 5.0, 10.0 ]
                }
            }
        },
        "load_path": "./plugins",
        "auto_load": true
    },
    "security": {
        "enable_security_headers": true,
        "allowed_origins": [ "*" ],
        "allowed_methods": [ "GET", "POST", "PUT", "DELETE", "OPTIONS", "PATCH" ],
        "allowed_headers": [ "*" ],
        "max_request_size": 10485760,
        "enable_rate_limiting": true,
        "cors_settings": {
            "allow_credentials": false,
            "max_age": 86400,
            "expose_headers": [ "X-Request-ID", "X-Rate-Limit-Remaining" ]
        },
        "security_headers": {
            "x_content_type_options": "nosniff",
            "x_frame_options": "DENY",
            "x_xss_protection": "1; mode=block",
            "strict_transport_security": "max-age=31536000; includeSubDomains",
            "referrer_policy": "strict-origin-when-cross-origin",
            "content_security_policy": "default-src 'self'"
        }
    },
    "logging": {
        "level": "INFO",
        "format": "json",
        "output": "stdout",
        "max_size": 100,
        "max_backups": 3,
        "max_age": 28,
        "compress": true,
        "fields": {
            "service": "ddos-protection",
            "version": "2.0.0",
            "environment": "production"
        }
    },
    "monitoring": {
        "health_check_interval": "30s",
        "metrics_collection": true,
        "performance_monitoring": true,
        "error_tracking": true,
        "alerts": {
            "high_cpu_threshold": 80,
            "high_memory_threshold": 85,
            "high_error_rate_threshold": 5,
            "response_time_threshold": "1s"
        }
    },
    "api": {
        "enable_admin_api": true,
        "admin_api_path": "/admin",
        "require_authentication": true,
        "api_keys": {
            "admin": "your-admin-api-key-here",
            "readonly": "your-readonly-api-key-here"
        },
        "rate_limits": {
            "admin_api": "100/1m",
            "public_api": "1000/1h"
        }
    }
}
