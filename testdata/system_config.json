{
    "server": {
        "address": "0.0.0.0",
        "port": 8080,
        "read_timeout": 10000000000,
        "write_timeout": 10000000000,
        "idle_timeout": 60000000000,
        "max_connections": 10000,
        "enable_prefork": false,
        "body_limit": 10485760,
        "trusted_proxies": [ ]
    },
    "engine": {
        "max_concurrent_requests": 1000,
        "request_timeout": 30000000000,
        "enable_metrics": true,
        "enable_events": true,
        "default_action": "allow",
        "failure_mode": "allow"
    },
    "store": {
        "type": "memory",
        "address": "",
        "password": "",
        "database": 0,
        "prefix": "",
        "max_retries": 3,
        "timeout": 5000000000,
        "options": null
    },
    "events": {
        "buffer_size": 1000,
        "worker_count": 4,
        "enable_async": true,
        "retry_attempts": 3
    },
    "plugins": {
        "detectors": {
            "rate_limit_detector": {
                "enabled": true,
                "priority": 90,
                "parameters": {
                    "burst_allowed": 10,
                    "key_template": "rate_limit:{ip}",
                    "max_requests": 100,
                    "window_size": "1m"
                }
            },
            "sql_injection_detector": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "custom_patterns": [ ]
                }
            },
            "multiple_signup_detector": {
                "enabled": true,
                "priority": 75,
                "parameters": {
                    "signup_endpoints": [ "/signup", "/register", "/api/signup", "/api/register" ],
                    "max_signups": 3,
                    "window_size": "1h",
                    "key_template": "multiple_signup:{ip}",
                    "track_usernames": true,
                    "username_limit": 5
                }
            },
            "generic_detector": {
                "enabled": true,
                "priority": 50,
                "parameters": {
                    "rules": [
                        {
                            "id": "sql_injection_pattern",
                            "name": "SQL Injection Pattern",
                            "description": "Detects common SQL injection patterns",
                            "enabled": true,
                            "type": "pattern",
                            "severity": 8,
                            "confidence": 0.8,
                            "priority": 90,
                            "conditions": [
                                {
                                    "field": "path",
                                    "operator": "regex",
                                    "value": "(?i)(union\\s+select|select\\s+.*\\s+from|insert\\s+into|delete\\s+from|drop\\s+table|create\\s+table)"
                                }
                            ],
                            "actions": [ "block_action" ],
                            "tags": [ "sql_injection", "web_attack", "injection" ]
                        },
                        {
                            "id": "xss_pattern",
                            "name": "XSS Pattern",
                            "description": "Detects common XSS patterns",
                            "enabled": true,
                            "type": "pattern",
                            "severity": 7,
                            "confidence": 0.7,
                            "priority": 85,
                            "conditions": [
                                {
                                    "field": "path",
                                    "operator": "regex",
                                    "value": "(?i)<\\s*script[^>]*>"
                                }
                            ],
                            "actions": [ "block_action" ],
                            "tags": [ "xss", "web_attack", "injection" ]
                        },
                        {
                            "id": "admin_path_access",
                            "name": "Admin Path Access",
                            "description": "Blocks access to admin paths without proper authentication",
                            "enabled": true,
                            "type": "path",
                            "severity": 6,
                            "confidence": 0.9,
                            "priority": 80,
                            "conditions": [
                                {
                                    "field": "path",
                                    "operator": "starts_with",
                                    "value": "/admin"
                                }
                            ],
                            "actions": [ "block_action" ],
                            "tags": [ "unauthorized_access", "admin_panel" ]
                        },
                        {
                            "id": "suspicious_user_agent",
                            "name": "Suspicious User Agent",
                            "description": "Blocks requests with suspicious user agents",
                            "enabled": true,
                            "type": "user_agent",
                            "severity": 5,
                            "confidence": 0.6,
                            "priority": 75,
                            "conditions": [
                                {
                                    "field": "user_agent",
                                    "operator": "contains",
                                    "value": "bot"
                                }
                            ],
                            "actions": [ "warning_action" ],
                            "tags": [ "suspicious", "bot" ]
                        }
                    ]
                }
            }
        },
        "actions": {
            "block_action": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "block_message": "Access denied due to security policy violation",
                    "default_duration": "5m",
                    "log_blocks": true,
                    "max_duration": "24h"
                }
            },
            "captcha_action": {
                "enabled": true,
                "priority": 75,
                "parameters": {
                    "provider": "simple",
                    "site_key": "",
                    "secret_key": "",
                    "threshold": 0.5,
                    "duration": "10m",
                    "max_attempts": 3,
                    "difficulty": "medium"
                }
            },
            "multiple_signup_action": {
                "enabled": true,
                "priority": 80,
                "parameters": {
                    "log_multiple_signups": true,
                    "notification_threshold": 3
                }
            },
            "warning_action": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "log_warnings": true,
                    "warning_message": "Security warning: suspicious activity detected"
                }
            }
        },
        "handlers": {
            "security_logger_handler": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "event_types": [
                        "*"
                    ],
                    "format": "json",
                    "log_file": "security_events.log",
                    "log_level": "INFO"
                }
            }
        },
        "load_path": "./plugins",
        "auto_load": true
    },
    "security": {
        "enable_security_headers": true,
        "allowed_origins": [
            "*"
        ],
        "allowed_methods": [
            "GET",
            "POST",
            "PUT",
            "DELETE",
            "OPTIONS"
        ],
        "allowed_headers": [
            "*"
        ],
        "max_request_size": 10485760,
        "enable_rate_limiting": true
    },
    "logging": {
        "level": "INFO",
        "format": "json",
        "output": "stdout",
        "max_size": 100,
        "max_backups": 3,
        "max_age": 28,
        "compress": true
    }
}
