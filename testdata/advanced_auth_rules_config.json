{
    "server": {
        "address": "0.0.0.0",
        "port": 8085,
        "read_timeout": 10000000000,
        "write_timeout": 10000000000,
        "idle_timeout": 60000000000,
        "max_connections": 10000,
        "enable_prefork": false,
        "body_limit": 10485760,
        "trusted_proxies": [ "127.0.0.1", "::1" ]
    },
    "engine": {
        "max_concurrent_requests": 1000,
        "request_timeout": 30000000000,
        "enable_metrics": true,
        "enable_events": true,
        "default_action": "allow",
        "failure_mode": "allow",
        "advanced_rules": [
            {
                "name": "LoginFailureRule",
                "description": "Detect multiple login failures from same IP with different usernames",
                "type": "authentication",
                "detectors": [
                    {
                        "name": "brute_force_detector",
                        "enabled": true,
                        "parameters": {
                            "login_endpoints": [ "/login", "/auth", "/signin", "/api/auth", "/admin/login" ],
                            "max_attempts": 3,
                            "window_size": "5m",
                            "key_template": "login_failure:{ip}",
                            "track_usernames": true,
                            "username_limit": 5,
                            "different_username_threshold": 3,
                            "failure_pattern_detection": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "captcha_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "incremental_block_action",
                                "condition": {
                                    "min_severity": 7,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 100,
                "enabled": true
            },
            {
                "name": "AfterHoursRule",
                "description": "Detect login attempts outside business hours",
                "type": "temporal",
                "detectors": [
                    {
                        "name": "time_based_detector",
                        "enabled": true,
                        "parameters": {
                            "business_hours": {
                                "start": "09:00",
                                "end": "18:00",
                                "timezone": "UTC",
                                "weekdays_only": true
                            },
                            "sensitive_endpoints": [ "/admin", "/config", "/api/admin" ],
                            "severity_multiplier": 2.0,
                            "track_user_patterns": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 2,
                                    "min_confidence": 0.5
                                }
                            },
                            {
                                "name": "captcha_action",
                                "condition": {
                                    "min_severity": 4,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 6,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 85,
                "enabled": true
            },
            {
                "name": "FailedAccessRule",
                "description": "Track failed access attempts to protected resources",
                "type": "access_control",
                "detectors": [
                    {
                        "name": "failed_access_detector",
                        "enabled": true,
                        "parameters": {
                            "protected_resources": [ "/admin/*", "/config/*", "/api/sensitive/*", "/dashboard/*" ],
                            "failure_threshold": 5,
                            "window_size": "10m",
                            "track_by_user": true,
                            "track_by_ip": true,
                            "escalation_pattern": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "incremental_block_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "suspension_action",
                                "condition": {
                                    "min_severity": 8,
                                    "min_confidence": 0.9
                                }
                            }
                        ]
                    }
                ],
                "priority": 90,
                "enabled": true
            },
            {
                "name": "MFABypassRule",
                "description": "Detect attempts to bypass multi-factor authentication",
                "type": "authentication",
                "detectors": [
                    {
                        "name": "mfa_bypass_detector",
                        "enabled": true,
                        "parameters": {
                            "mfa_endpoints": [ "/mfa/verify", "/2fa/validate", "/auth/mfa" ],
                            "bypass_patterns": [
                                "skip_mfa",
                                "bypass_2fa",
                                "mfa=false",
                                "disable_mfa"
                            ],
                            "suspicious_headers": [
                                "X-Skip-MFA",
                                "X-Bypass-2FA",
                                "X-Force-Login"
                            ],
                            "rapid_attempts_threshold": 10,
                            "window_size": "2m"
                        },
                        "actions": [
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 1,
                                    "min_confidence": 0.8
                                }
                            },
                            {
                                "name": "account_suspend_action",
                                "condition": {
                                    "min_severity": 7,
                                    "min_confidence": 0.9
                                }
                            }
                        ]
                    }
                ],
                "priority": 95,
                "enabled": true
            },
            {
                "name": "SuccessfulLoginAfterFailuresRule",
                "description": "Detect successful login immediately after multiple failures",
                "type": "authentication",
                "detectors": [
                    {
                        "name": "login_pattern_detector",
                        "enabled": true,
                        "parameters": {
                            "failure_threshold": 3,
                            "success_window": "30s",
                            "track_by_ip": true,
                            "track_by_username": true,
                            "suspicious_success_pattern": true,
                            "credential_stuffing_detection": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 4,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "captcha_action",
                                "condition": {
                                    "min_severity": 6,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 88,
                "enabled": true
            },
            {
                "name": "PasswordResetSpikeRule",
                "description": "Detect unusual spikes in password reset requests",
                "type": "authentication",
                "detectors": [
                    {
                        "name": "password_reset_detector",
                        "enabled": true,
                        "parameters": {
                            "reset_endpoints": [ "/password/reset", "/forgot-password", "/api/reset-password" ],
                            "normal_rate": 5,
                            "spike_multiplier": 3.0,
                            "window_size": "5m",
                            "track_by_ip": true,
                            "track_by_email_domain": true,
                            "enumeration_detection": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "rate_limit_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 7,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 80,
                "enabled": true
            }
        ]
    },
    "store": {
        "type": "memory",
        "address": "",
        "password": "",
        "database": 0,
        "prefix": "auth_guard:",
        "max_retries": 3,
        "timeout": 5000000000,
        "options": {
            "cleanup_interval": "1m",
            "max_memory_usage": "100MB"
        }
    },
    "events": {
        "buffer_size": 1000,
        "worker_count": 4,
        "enable_async": true,
        "retry_attempts": 3
    },
    "plugins": {
        "detectors": {
            "brute_force_detector": {
                "enabled": true,
                "priority": 100,
                "parameters": { }
            },
            "time_based_detector": {
                "enabled": true,
                "priority": 85,
                "parameters": { }
            },
            "failed_access_detector": {
                "enabled": true,
                "priority": 90,
                "parameters": { }
            },
            "mfa_bypass_detector": {
                "enabled": true,
                "priority": 95,
                "parameters": { }
            },
            "login_pattern_detector": {
                "enabled": true,
                "priority": 88,
                "parameters": { }
            },
            "password_reset_detector": {
                "enabled": true,
                "priority": 80,
                "parameters": { }
            }
        },
        "actions": {
            "block_action": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "default_duration": "15m",
                    "max_duration": "24h",
                    "block_message": "Access denied due to authentication security violation",
                    "log_blocks": true
                }
            },
            "incremental_block_action": {
                "enabled": true,
                "priority": 90,
                "parameters": {
                    "initial_duration": "5m",
                    "max_duration": "4h",
                    "multiplier": 2.0,
                    "reset_after": "24h"
                }
            },
            "suspension_action": {
                "enabled": true,
                "priority": 85,
                "parameters": {
                    "default_duration": "2h",
                    "max_duration": "7d",
                    "require_manual_review": true,
                    "notification_email": "security@example.com"
                }
            },
            "account_suspend_action": {
                "enabled": true,
                "priority": 95,
                "parameters": {
                    "permanent": false,
                    "require_admin_approval": true,
                    "notification_email": "admin@example.com",
                    "log_suspension": true
                }
            },
            "captcha_action": {
                "enabled": true,
                "priority": 75,
                "parameters": {
                    "provider": "simple",
                    "duration": "15m",
                    "max_attempts": 3,
                    "difficulty": "hard"
                }
            },
            "warning_action": {
                "enabled": true,
                "priority": 50,
                "parameters": {
                    "log_warnings": true,
                    "include_details": true,
                    "rate_limit_warnings": true,
                    "max_warnings_per_hour": 100
                }
            },
            "rate_limit_action": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "requests_per_minute": 10,
                    "burst_allowed": 3,
                    "duration": "10m"
                }
            }
        },
        "handlers": {
            "security_logger_handler": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "log_file": "auth_security_events.log",
                    "log_level": "INFO",
                    "event_types": [ "*" ],
                    "format": "json",
                    "max_file_size": "100MB",
                    "max_backups": 5,
                    "compress": true,
                    "include_request_details": true
                }
            },
            "metrics_handler": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "export_interval": "30s",
                    "metrics_endpoint": "/metrics",
                    "include_labels": true,
                    "histogram_buckets": [ 0.1, 0.5, 1.0, 2.5, 5.0, 10.0 ]
                }
            }
        },
        "load_path": "./plugins",
        "auto_load": true
    },
    "security": {
        "enable_security_headers": true,
        "allowed_origins": [ "*" ],
        "allowed_methods": [ "GET", "POST", "PUT", "DELETE", "OPTIONS" ],
        "allowed_headers": [ "*" ],
        "max_request_size": 10485760,
        "enable_rate_limiting": true
    },
    "logging": {
        "level": "INFO",
        "format": "json",
        "output": "stdout",
        "max_size": 100,
        "max_backups": 3,
        "max_age": 28,
        "compress": true,
        "fields": {
            "service": "auth-guard",
            "version": "2.0.0",
            "environment": "demo"
        }
    }
}
