{
    "server": {
        "address": "0.0.0.0",
        "port": 8087,
        "read_timeout": 10000000000,
        "write_timeout": 10000000000,
        "idle_timeout": 60000000000,
        "max_connections": 10000,
        "enable_prefork": false,
        "body_limit": 10485760,
        "trusted_proxies": [ "127.0.0.1", "::1" ]
    },
    "engine": {
        "max_concurrent_requests": 1000,
        "request_timeout": 30000000000,
        "enable_metrics": true,
        "enable_events": true,
        "default_action": "allow",
        "failure_mode": "deny",
        "advanced_rules": [
            {
                "name": "DataExfiltrationRule",
                "description": "Detect potential data exfiltration attempts",
                "type": "data_protection",
                "detectors": [
                    {
                        "name": "data_exfiltration_detector",
                        "enabled": true,
                        "parameters": {
                            "large_response_threshold": "10MB",
                            "bulk_download_threshold": 100,
                            "sensitive_data_patterns": [
                                "(?i)(ssn|social.security)",
                                "(?i)(credit.card|cc.number)",
                                "(?i)(password|passwd|pwd)",
                                "(?i)(api.key|secret.key|private.key)",
                                "(?i)(email|e-mail).*@.*\\.",
                                "(?i)(phone|tel|mobile).*\\d{10}"
                            ],
                            "unusual_export_patterns": true,
                            "time_window": "5m",
                            "volume_threshold": "50MB"
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 4,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "data_loss_prevention_action",
                                "condition": {
                                    "min_severity": 6,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 8,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 95,
                "enabled": true
            },
            {
                "name": "InjectionDetectionRule",
                "description": "Advanced injection attack detection (SQL, NoSQL, LDAP, Command)",
                "type": "injection_protection",
                "detectors": [
                    {
                        "name": "advanced_injection_detector",
                        "enabled": true,
                        "parameters": {
                            "sql_injection_patterns": [
                                "(?i)(union|select|insert|update|delete|drop|create|alter)\\s+",
                                "(?i)'\\s*(or|and)\\s*'",
                                "(?i)\\b(exec|execute|sp_|xp_)\\w*\\s*\\(",
                                "(?i)--\\s*$",
                                "(?i)/\\*.*\\*/",
                                "(?i)\\b(waitfor|delay)\\s+",
                                "(?i)\\b(benchmark|sleep)\\s*\\("
                            ],
                            "nosql_injection_patterns": [
                                "(?i)\\$where",
                                "(?i)\\$ne",
                                "(?i)\\$gt",
                                "(?i)\\$regex",
                                "(?i)\\$or",
                                "(?i)\\$and"
                            ],
                            "ldap_injection_patterns": [
                                "\\*\\)",
                                "\\(\\|",
                                "\\)\\(",
                                "\\*\\|"
                            ],
                            "command_injection_patterns": [
                                "(?i)(;|\\||&|`|\\$\\()",
                                "(?i)\\b(cat|ls|pwd|whoami|id|uname)\\b",
                                "(?i)\\b(wget|curl|nc|netcat)\\b"
                            ],
                            "check_all_parameters": true,
                            "decode_payloads": true,
                            "context_analysis": true
                        },
                        "actions": [
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 1,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "security_alert_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 100,
                "enabled": true
            },
            {
                "name": "PermissionEscalationAttemptRule",
                "description": "Detect attempts to escalate privileges or access unauthorized resources",
                "type": "access_control",
                "detectors": [
                    {
                        "name": "privilege_escalation_detector",
                        "enabled": true,
                        "parameters": {
                            "admin_endpoints": [ "/admin/*", "/config/*", "/system/*", "/api/admin/*" ],
                            "privilege_escalation_patterns": [
                                "(?i)(sudo|su|runas)",
                                "(?i)(admin|administrator|root)",
                                "(?i)(privilege|permission|role).*escalat",
                                "(?i)(bypass|override).*auth"
                            ],
                            "unauthorized_access_attempts": true,
                            "role_manipulation_detection": true,
                            "token_manipulation_detection": true,
                            "session_hijacking_detection": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "account_suspend_action",
                                "condition": {
                                    "min_severity": 8,
                                    "min_confidence": 0.9
                                }
                            }
                        ]
                    }
                ],
                "priority": 95,
                "enabled": true
            },
            {
                "name": "SensitiveDataAccessRule",
                "description": "Monitor and control access to sensitive data endpoints",
                "type": "data_protection",
                "detectors": [
                    {
                        "name": "sensitive_data_access_detector",
                        "enabled": true,
                        "parameters": {
                            "sensitive_endpoints": [
                                "/api/users/*/personal",
                                "/api/financial/*",
                                "/api/medical/*",
                                "/api/confidential/*",
                                "/data/export/*",
                                "/reports/sensitive/*"
                            ],
                            "data_classification_levels": [
                                "confidential",
                                "restricted",
                                "internal",
                                "public"
                            ],
                            "access_pattern_analysis": true,
                            "unusual_access_detection": true,
                            "bulk_access_threshold": 50,
                            "time_based_restrictions": true
                        },
                        "actions": [
                            {
                                "name": "access_log_action",
                                "condition": {
                                    "min_severity": 1,
                                    "min_confidence": 0.5
                                }
                            },
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "data_access_review_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.7
                                }
                            }
                        ]
                    }
                ],
                "priority": 90,
                "enabled": true
            },
            {
                "name": "UnauthorizedConfigChangeRule",
                "description": "Detect unauthorized attempts to modify system configuration",
                "type": "configuration_protection",
                "detectors": [
                    {
                        "name": "config_change_detector",
                        "enabled": true,
                        "parameters": {
                            "config_endpoints": [
                                "/config/*",
                                "/settings/*",
                                "/admin/config/*",
                                "/api/config/*",
                                "/system/settings/*"
                            ],
                            "critical_config_patterns": [
                                "(?i)(password|secret|key|token)",
                                "(?i)(database|db|connection)",
                                "(?i)(security|auth|permission)",
                                "(?i)(admin|root|superuser)"
                            ],
                            "unauthorized_methods": [ "PUT", "POST", "PATCH", "DELETE" ],
                            "change_frequency_monitoring": true,
                            "rollback_detection": true
                        },
                        "actions": [
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 1,
                                    "min_confidence": 0.8
                                }
                            },
                            {
                                "name": "security_alert_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.9
                                }
                            },
                            {
                                "name": "config_backup_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.7
                                }
                            }
                        ]
                    }
                ],
                "priority": 98,
                "enabled": true
            },
            {
                "name": "AuditLogIntegrityRule",
                "description": "Monitor audit log integrity and detect tampering attempts",
                "type": "audit_protection",
                "detectors": [
                    {
                        "name": "audit_integrity_detector",
                        "enabled": true,
                        "parameters": {
                            "audit_endpoints": [
                                "/logs/*",
                                "/audit/*",
                                "/api/logs/*",
                                "/system/audit/*"
                            ],
                            "tampering_indicators": [
                                "log_deletion_attempts",
                                "log_modification_attempts",
                                "timestamp_manipulation",
                                "log_injection_attempts"
                            ],
                            "integrity_check_interval": "5m",
                            "checksum_validation": true,
                            "log_sequence_validation": true
                        },
                        "actions": [
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 1,
                                    "min_confidence": 0.9
                                }
                            },
                            {
                                "name": "security_alert_action",
                                "condition": {
                                    "min_severity": 7,
                                    "min_confidence": 0.9
                                }
                            },
                            {
                                "name": "audit_backup_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.8
                                }
                            }
                        ]
                    }
                ],
                "priority": 99,
                "enabled": true
            },
            {
                "name": "TokenReuseRule",
                "description": "Detect suspicious token reuse patterns",
                "type": "token_security",
                "detectors": [
                    {
                        "name": "token_reuse_detector",
                        "enabled": true,
                        "parameters": {
                            "token_types": [ "jwt", "oauth", "api_key", "session_token" ],
                            "reuse_threshold": 5,
                            "time_window": "1h",
                            "different_ip_reuse": true,
                            "expired_token_usage": true,
                            "token_replay_detection": true,
                            "concurrent_usage_detection": true
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 3,
                                    "min_confidence": 0.6
                                }
                            },
                            {
                                "name": "token_invalidate_action",
                                "condition": {
                                    "min_severity": 5,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "account_suspend_action",
                                "condition": {
                                    "min_severity": 8,
                                    "min_confidence": 0.9
                                }
                            }
                        ]
                    }
                ],
                "priority": 85,
                "enabled": true
            },
            {
                "name": "VulnerableAuthMethodRule",
                "description": "Detect usage of vulnerable authentication methods",
                "type": "authentication_security",
                "detectors": [
                    {
                        "name": "vulnerable_auth_detector",
                        "enabled": true,
                        "parameters": {
                            "vulnerable_methods": [
                                "basic_auth_over_http",
                                "weak_password_auth",
                                "deprecated_oauth_versions",
                                "insecure_token_storage"
                            ],
                            "weak_password_patterns": [
                                "(?i)(password|123456|admin|root)",
                                "^.{1,7}$",
                                "^[a-z]+$",
                                "^[0-9]+$"
                            ],
                            "insecure_protocols": [ "http", "ftp", "telnet" ],
                            "deprecated_ciphers": [ "md5", "sha1", "des" ]
                        },
                        "actions": [
                            {
                                "name": "warning_action",
                                "condition": {
                                    "min_severity": 2,
                                    "min_confidence": 0.7
                                }
                            },
                            {
                                "name": "force_secure_auth_action",
                                "condition": {
                                    "min_severity": 4,
                                    "min_confidence": 0.8
                                }
                            },
                            {
                                "name": "block_action",
                                "condition": {
                                    "min_severity": 6,
                                    "min_confidence": 0.9
                                }
                            }
                        ]
                    }
                ],
                "priority": 88,
                "enabled": true
            }
        ]
    },
    "store": {
        "type": "memory",
        "address": "",
        "password": "",
        "database": 0,
        "prefix": "security_guard:",
        "max_retries": 3,
        "timeout": 5000000000,
        "options": {
            "cleanup_interval": "1m",
            "max_memory_usage": "200MB"
        }
    },
    "events": {
        "buffer_size": 2000,
        "worker_count": 8,
        "enable_async": true,
        "retry_attempts": 3
    },
    "plugins": {
        "detectors": {
            "data_exfiltration_detector": {
                "enabled": true,
                "priority": 95,
                "parameters": { }
            },
            "advanced_injection_detector": {
                "enabled": true,
                "priority": 100,
                "parameters": { }
            },
            "privilege_escalation_detector": {
                "enabled": true,
                "priority": 95,
                "parameters": { }
            },
            "sensitive_data_access_detector": {
                "enabled": true,
                "priority": 90,
                "parameters": { }
            },
            "config_change_detector": {
                "enabled": true,
                "priority": 98,
                "parameters": { }
            },
            "audit_integrity_detector": {
                "enabled": true,
                "priority": 99,
                "parameters": { }
            },
            "token_reuse_detector": {
                "enabled": true,
                "priority": 85,
                "parameters": { }
            },
            "vulnerable_auth_detector": {
                "enabled": true,
                "priority": 88,
                "parameters": { }
            }
        },
        "actions": {
            "block_action": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "default_duration": "30m",
                    "max_duration": "24h",
                    "block_message": "Access denied due to security policy violation",
                    "log_blocks": true
                }
            },
            "warning_action": {
                "enabled": true,
                "priority": 50,
                "parameters": {
                    "log_warnings": true,
                    "include_details": true,
                    "rate_limit_warnings": true,
                    "max_warnings_per_hour": 500
                }
            },
            "security_alert_action": {
                "enabled": true,
                "priority": 95,
                "parameters": {
                    "alert_channels": [ "email", "slack", "webhook" ],
                    "severity_threshold": 7,
                    "immediate_notification": true
                }
            },
            "data_loss_prevention_action": {
                "enabled": true,
                "priority": 90,
                "parameters": {
                    "block_large_transfers": true,
                    "quarantine_sensitive_data": true,
                    "notify_data_officer": true
                }
            },
            "account_suspend_action": {
                "enabled": true,
                "priority": 95,
                "parameters": {
                    "permanent": false,
                    "require_admin_approval": true,
                    "notification_email": "security@example.com",
                    "log_suspension": true
                }
            },
            "access_log_action": {
                "enabled": true,
                "priority": 40,
                "parameters": {
                    "detailed_logging": true,
                    "include_request_body": false,
                    "include_response_headers": true
                }
            },
            "data_access_review_action": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "require_justification": true,
                    "approval_required": true,
                    "audit_trail": true
                }
            },
            "config_backup_action": {
                "enabled": true,
                "priority": 80,
                "parameters": {
                    "backup_before_change": true,
                    "versioning": true,
                    "integrity_check": true
                }
            },
            "audit_backup_action": {
                "enabled": true,
                "priority": 85,
                "parameters": {
                    "immediate_backup": true,
                    "secure_storage": true,
                    "tamper_proof": true
                }
            },
            "token_invalidate_action": {
                "enabled": true,
                "priority": 75,
                "parameters": {
                    "invalidate_all_sessions": false,
                    "force_reauth": true,
                    "notify_user": true
                }
            },
            "force_secure_auth_action": {
                "enabled": true,
                "priority": 80,
                "parameters": {
                    "require_mfa": true,
                    "force_password_change": true,
                    "upgrade_auth_method": true
                }
            }
        },
        "handlers": {
            "security_logger_handler": {
                "enabled": true,
                "priority": 100,
                "parameters": {
                    "log_file": "security_data_protection_events.log",
                    "log_level": "INFO",
                    "event_types": [ "*" ],
                    "format": "json",
                    "max_file_size": "100MB",
                    "max_backups": 10,
                    "compress": true,
                    "include_request_details": true
                }
            },
            "metrics_handler": {
                "enabled": true,
                "priority": 70,
                "parameters": {
                    "export_interval": "30s",
                    "metrics_endpoint": "/metrics",
                    "include_labels": true,
                    "histogram_buckets": [ 0.1, 0.5, 1.0, 2.5, 5.0, 10.0 ]
                }
            }
        },
        "load_path": "./plugins",
        "auto_load": true
    },
    "security": {
        "enable_security_headers": true,
        "allowed_origins": [ "*" ],
        "allowed_methods": [ "GET", "POST", "PUT", "DELETE", "OPTIONS" ],
        "allowed_headers": [ "*" ],
        "max_request_size": 10485760,
        "enable_rate_limiting": true
    },
    "logging": {
        "level": "INFO",
        "format": "json",
        "output": "stdout",
        "max_size": 100,
        "max_backups": 5,
        "max_age": 28,
        "compress": true,
        "fields": {
            "service": "security-data-protection-guard",
            "version": "2.0.0",
            "environment": "demo"
        }
    }
}
