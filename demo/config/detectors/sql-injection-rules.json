{
    "detector": {
        "name": "generic_detector",
        "enabled": true,
        "priority": 50,
        "parameters": {
            "rules": [
                {
                    "id": "sql_injection_union_select",
                    "name": "SQL Injection - UNION SELECT",
                    "description": "Detects SQL injection attempts using UNION SELECT",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 9,
                    "confidence": 0.9,
                    "priority": 100,
                    "conditions": [
                        {
                            "logical": "or",
                            "children": [
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "union select"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "select"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "insert into"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "delete from"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "drop table"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "create table"
                                }
                            ]
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection", "high_risk" ]
                },
                {
                    "id": "sql_injection_or_and",
                    "name": "SQL Injection - OR/AND",
                    "description": "Detects SQL injection attempts using OR/AND conditions",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 8,
                    "confidence": 0.8,
                    "priority": 95,
                    "conditions": [
                        {
                            "logical": "or",
                            "children": [
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "' or '"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "' and '"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "'or'"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "'and'"
                                }
                            ]
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection" ]
                },
                {
                    "id": "sql_injection_exec",
                    "name": "SQL Injection - EXEC/SP",
                    "description": "Detects SQL injection attempts using EXEC or stored procedures",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 9,
                    "confidence": 0.9,
                    "priority": 98,
                    "conditions": [
                        {
                            "logical": "or",
                            "children": [
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "exec("
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "execute("
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "sp_"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "xp_"
                                }
                            ]
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection", "stored_procedure" ]
                },
                {
                    "id": "sql_injection_comments",
                    "name": "SQL Injection - Comments",
                    "description": "Detects SQL injection attempts using SQL comments",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 7,
                    "confidence": 0.7,
                    "priority": 90,
                    "conditions": [
                        {
                            "logical": "or",
                            "children": [
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "--"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "/*"
                                },
                                {
                                    "field": "path",
                                    "operator": "contains",
                                    "value": "*/"
                                }
                            ]
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection", "comment_injection" ]
                },
                {
                    "id": "body_sql_injection",
                    "name": "Body SQL Injection Detection",
                    "description": "Detects SQL injection patterns in request body content",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 9,
                    "confidence": 0.9,
                    "priority": 100,
                    "conditions": [
                        {
                            "logical": "or",
                            "children": [
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "union select"
                                },
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "drop table"
                                },
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "insert into"
                                },
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "delete from"
                                },
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "update"
                                },
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "exec("
                                },
                                {
                                    "field": "body",
                                    "operator": "contains",
                                    "value": "execute("
                                }
                            ]
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "body", "web_attack", "injection", "high_risk" ]
                }
            ]
        }
    },
    "action_rules": [
        {
            "name": "Critical SQL Injection Block",
            "description": "Block critical SQL injection threats immediately",
            "min_severity": 9,
            "min_confidence": 0.8,
            "actions": [ "block_action" ],
            "threat_tags": [ "sql_injection", "high_risk" ],
            "priority": 100,
            "enabled": true
        },
        {
            "name": "SQL Injection Block",
            "description": "Block SQL injection attempts",
            "min_severity": 7,
            "min_confidence": 0.7,
            "actions": [ "block_action" ],
            "threat_tags": [ "sql_injection" ],
            "priority": 95,
            "enabled": true
        }
    ]
}
