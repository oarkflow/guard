{
    "detector": {
        "name": "generic_detector",
        "enabled": true,
        "priority": 50,
        "parameters": {
            "rules": [
                {
                    "id": "sql_injection_pattern",
                    "name": "SQL Injection Pattern",
                    "description": "Detects common SQL injection patterns",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 8,
                    "confidence": 0.8,
                    "priority": 90,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "regex",
                            "value": "(?i)(union\\s+select|select\\s+.*\\s+from|insert\\s+into|delete\\s+from|drop\\s+table|create\\s+table)"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection" ]
                },
                {
                    "id": "xss_pattern",
                    "name": "XSS Pattern",
                    "description": "Detects common XSS patterns",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 7,
                    "confidence": 0.7,
                    "priority": 85,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "regex",
                            "value": "(?i)<\\s*script[^>]*>"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "xss", "web_attack", "injection" ]
                },
                {
                    "id": "admin_path_access",
                    "name": "Admin Path Access",
                    "description": "Blocks access to admin paths without proper authentication",
                    "enabled": true,
                    "type": "path",
                    "severity": 6,
                    "confidence": 0.9,
                    "priority": 80,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "starts_with",
                            "value": "/admin"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "unauthorized_access", "admin_panel" ]
                },
                {
                    "id": "suspicious_user_agent",
                    "name": "Suspicious User Agent",
                    "description": "Blocks requests with suspicious user agents",
                    "enabled": true,
                    "type": "user_agent",
                    "severity": 5,
                    "confidence": 0.6,
                    "priority": 75,
                    "conditions": [
                        {
                            "field": "user_agent",
                            "operator": "contains",
                            "value": "bot"
                        }
                    ],
                    "actions": [ "warning_action" ],
                    "tags": [ "suspicious", "bot" ]
                }
            ]
        }
    },
    "action_rules": [
        {
            "name": "High Severity Block",
            "description": "Block high severity threats",
            "min_severity": 7,
            "min_confidence": 0.7,
            "actions": [ "block_action" ],
            "threat_tags": [ "web_attack", "injection" ],
            "priority": 95,
            "enabled": true
        },
        {
            "name": "Medium Severity Warning",
            "description": "Warn for medium severity threats",
            "min_severity": 5,
            "min_confidence": 0.5,
            "actions": [ "warning_action" ],
            "threat_tags": [ "suspicious" ],
            "priority": 80,
            "enabled": true
        }
    ]
}
