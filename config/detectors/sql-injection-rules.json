{
    "detector": {
        "name": "generic_detector",
        "enabled": true,
        "priority": 50,
        "parameters": {
            "rules": [
                {
                    "id": "sql_injection_union_select",
                    "name": "SQL Injection - UNION SELECT",
                    "description": "Detects SQL injection attempts using UNION SELECT",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 9,
                    "confidence": 0.9,
                    "priority": 100,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "regex",
                            "value": "(?i)(union\\s+select|select\\s+.*\\s+from|insert\\s+into|delete\\s+from|drop\\s+table|create\\s+table)"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection", "high_risk" ]
                },
                {
                    "id": "sql_injection_or_and",
                    "name": "SQL Injection - OR/AND",
                    "description": "Detects SQL injection attempts using OR/AND conditions",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 8,
                    "confidence": 0.8,
                    "priority": 95,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "regex",
                            "value": "(?i)'\\s*(or|and)\\s*'"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection" ]
                },
                {
                    "id": "sql_injection_exec",
                    "name": "SQL Injection - EXEC/SP",
                    "description": "Detects SQL injection attempts using EXEC or stored procedures",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 9,
                    "confidence": 0.9,
                    "priority": 98,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "regex",
                            "value": "(?i)\\b(exec|execute|sp_|xp_)\\w*\\s*\\("
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection", "stored_procedure" ]
                },
                {
                    "id": "sql_injection_comments",
                    "name": "SQL Injection - Comments",
                    "description": "Detects SQL injection attempts using SQL comments",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 7,
                    "confidence": 0.7,
                    "priority": 90,
                    "conditions": [
                        {
                            "field": "path",
                            "operator": "regex",
                            "value": "(?i)(--\\s*$|/\\*.*\\*/)"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "web_attack", "injection", "comment_injection" ]
                },
                {
                    "id": "body_sql_injection",
                    "name": "Body SQL Injection Detection",
                    "description": "Detects SQL injection patterns in request body content",
                    "enabled": true,
                    "type": "pattern",
                    "severity": 9,
                    "confidence": 0.9,
                    "priority": 100,
                    "conditions": [
                        {
                            "field": "body",
                            "operator": "regex",
                            "value": "(?i)(union\\s+select|drop\\s+table|insert\\s+into|delete\\s+from|update\\s+.*\\s+set|exec\\s*\\(|execute\\s*\\()"
                        }
                    ],
                    "actions": [ "block_action" ],
                    "tags": [ "sql_injection", "body", "web_attack", "injection", "high_risk" ]
                }
            ]
        }
    },
    "action_rules": [
        {
            "name": "Critical SQL Injection Block",
            "description": "Block critical SQL injection threats immediately",
            "min_severity": 9,
            "min_confidence": 0.8,
            "actions": [ "block_action" ],
            "threat_tags": [ "sql_injection", "high_risk" ],
            "priority": 100,
            "enabled": true
        },
        {
            "name": "SQL Injection Block",
            "description": "Block SQL injection attempts",
            "min_severity": 7,
            "min_confidence": 0.7,
            "actions": [ "block_action" ],
            "threat_tags": [ "sql_injection" ],
            "priority": 95,
            "enabled": true
        }
    ]
}
